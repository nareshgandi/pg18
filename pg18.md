Allow skip scans of btree indexes

These performance gains extend to query optimizations and new indexing features. PostgreSQL 18 adds support for using "skip scan" lookups on multicolumn B-tree indexes, which can result in faster execution times for queries that omit a "=" condition on one or more prefix index columns.

This release also includes optimizations for WHERE clauses that contain OR and IN (...) statements to better utilize recent indexing improvements which can also result in better query performance.

PostgreSQL 18 now supports parallel builds for GIN indexes, which are commonly used for search over JSON and full-text data. 

CREATE TABLE articles (
id serial PRIMARY KEY,
title text,
body text
);

INSERT INTO articles (title, body)
SELECT
'Title ' || g,
repeat('This is a sample article content with some searchable keywords. ', 10)
FROM generate_series(1, 500000) g;

CREATE INDEX gin_articles_body_idx ON articles
USING GIN (to_tsvector('english', body));

 Example 2: JSONB GIN Index with Parallel Build

Step 1: Create a table with JSONB data

CREATE TABLE logs (
id serial PRIMARY KEY,
data jsonb
);

Step 2: Insert dummy JSONB records

INSERT INTO logs (data)
SELECT jsonb_build_object(
'user_id', trunc(random()*1000000)::int,
'event', 'click',
'details', jsonb_build_object('url', 'https://example.com/' || g)
)
FROM generate_series(1, 500000) g;

Step 3: Create a GIN index on the jsonb column

CREATE INDEX gin_logs_data_idx ON logs
USING GIN (data);

-- This build will be parallelized if the planner decides it's worthwhile

Step 4: Run a JSONB query that benefits from the GIN index

SELECT *
FROM logs
WHERE data @> '{"event": "click"}';

üõ†Ô∏è How to Monitor Parallel Index Usage

Use EXPLAIN (ANALYZE, VERBOSE, BUFFERS) while building the index:

EXPLAIN (ANALYZE, VERBOSE)
CREATE INDEX gin_logs_data_idx ON logs
USING GIN (data);
